# Smart Validation System

מערכת בדיקה חכמה שמזהה בעיות בקוד ומציעה תיקונים מבוססי הקשר במקום תיקונים אוטומטיים פשוטים.

## מה זה עושה?

במקום פשוט להחליף טקסט אוטומטית, המערכת:

1. **מזהה בעיות ספציפיות** בקוד (כמו שימוש שגוי ב-`meeting.modules`)
2. **מסבירה את הבעיה** בהקשר של הקוד הספציפי
3. **מציעה תיקון מבוסס הקשר** עם הסבר למה זה נכון
4. **מאפשרת תיקון אוטומטי** רק אחרי הסבר מלא למשתמש

## שימוש

### בדיקה בסיסית
```bash
npm run validate:prefill
```

### תיקון אוטומטי
```bash
npm run validate:prefill:fix
```

### שימוש ישיר בסקריפט
```bash
node scripts/validate-prefill.js
node scripts/validate-prefill.js --fix
```

## סוגי בעיות שמזוהות

### 1. שימוש שגוי ב-`meeting.modules`
**בעיה**: פונקציות שמקבלות `modules` כפרמטר משתמשות ב-`meeting.modules`
**הסבר**: הפונקציה לא מקבלת את האובייקט `meeting` כפרמטר, רק את `modules`
**תיקון**: החלפת `meeting.modules` ב-`modules`

### 2. שימוש ב-`console.log` במקום `logger`
**בעיה**: שימוש ישיר ב-`console.log` במקום במערכת הרישום המאוחדת
**הסבר**: מומלץ להשתמש ב-`consoleLogger` לרישום אחיד ויעיל
**תיקון**: החלפת `console.log(` ב-`logger.info(`

### 3. שימוש בטייפ `any`
**בעיה**: שימוש בטייפ `any` במקום טייפים ספציפיים
**הסבר**: טייפים ספציפיים משפרים את בטיחות הטייפים
**תיקון**: החלפת `: any` בטייפ ספציפי יותר כמו `: unknown`

## איך זה עובד?

### שלב 1: זיהוי
המערכת סורקת את הקובץ ומחפשת דפוסים בעייתיים באמצעות regex מתקדמות.

### שלב 2: ניתוח הקשר
לכל בעיה שנמצאה, המערכת מנתחת את הקונטקסט:
- באיזה פונקציה זה קורה?
- מה הטייפים הצפויים?
- מה ההקשר העסקי?

### שלב 3: הצעת תיקון
במקום תיקון אוטומטי, המערכת מסבירה:
- מה הבעיה הספציפית
- למה זה בעייתי בהקשר הזה
- איך צריך לתקן את זה

### שלב 4: תיקון מבוקר
רק אחרי הסבר מלא, המשתמש יכול לבחור להחיל את התיקונים.

## יתרונות על פני תיקונים אוטומטיים

✅ **הסבר מפורט** - מבין למה הבעיה קיימת
✅ **תיקון מבוסס הקשר** - לא רק החלפה עיוורת
✅ **למידה** - עוזר למפתח להבין את הטעות
✅ **גמישות** - מאפשר למשתמש לבחור מה לתקן
✅ **בטיחות** - לא משנה דברים בלי הסבר

## הרחבת המערכת

אפשר להוסיף בקלות זיהוי של בעיות נוספות:

```javascript
// הוסף ל-findIssues()
const newPattern = /בעיה חדשה/g;
let newMatch;
while ((newMatch = newPattern.exec(this.content)) !== null) {
  this.issues.push({
    type: 'new-issue-type',
    explanation: 'הסבר על הבעיה החדשה',
    fix: { /* תיקון מוצע */ }
  });
}
```

## דוגמה לשימוש

```bash
$ npm run validate:prefill

🚀 הפעלת בדיקה חכמה של קובץ requirementsPrefillEngine.ts

============================================================

🔍 Running smart validation...

🚨 נמצאו 2 בעיות:

1. בעיה בפונקציה: prefillCRMRequirements
   שורה: 121, עמודה: 48
   קטע קוד: prefilled.crm_users_count = employeeRanges[meeting.modules?.operations?.hr?.employeeCount] || 10;
   הסבר: הפונקציה prefillCRMRequirements מקבלת את הפרמטר 'modules' אבל משתמשת ב-meeting.modules.
            זה שגוי כי הפונקציה לא מקבלת את האובייקט meeting כפרמטר, רק את modules.
            צריך להשתמש ב-modules שהועבר כפרמטר במקום ב-meeting.modules.
   תיקון מוצע: meeting.modules → modules

💡 הצעות לתיקון:

1. עבור הפונקציה prefillCRMRequirements:
   ```typescript
   // במקום:
   meeting.modules

   // השתמש ב:
   modules
   ```

============================================================

📋 נמצאו 2 בעיות שדורשות טיפול

🔧 להחלת תיקונים אוטומטיים: npm run validate:prefill:fix
```

המערכת הזו חוסכת זמן רב במציאת ותיקון בעיות, ומספקת הסברים שיעזרו לך להבין וללמוד מהטעויות.
